<view class="container">
  <view class="title">新建工单</view>

  <input class="input" placeholder="请输入工单标题" bindinput="onTitleInput" />

  <textarea class="textarea" placeholder="请输入问题描述" bindinput="onDescInput"></textarea>

  <view class="section">
    <text class="label">上传图片（可选）</text>
    <!-- 选择按钮：不足3张时可继续添加 -->
    <button
      class="choose-btn"
      wx:if="{{images.length < 3}}"
      catchtap="chooseImage"
    >选择图片（剩{{3 - images.length}}）</button>

    <!-- 缩略图网格：可预览、可删除 -->
    <view class="img-grid">
      <block wx:for="{{images}}" wx:key="*this">
        <view class="img-cell">
          <image class="thumb" src="{{item}}" mode="aspectFill"
                 data-src="{{item}}" catchtap="previewImage" />
          <view class="img-del" data-index="{{index}}" catchtap="removeImage">×</view>
        </view>
      </block>
    </view>
  </view>

  <input class="input" placeholder="请输入联系方式" bindinput="onPhoneInput" />

  <view class="form-item">
    <input placeholder="请输入详细地址" bindinput="onAddressInput" value="{{address}}" />
  </view>

  <view class="form-item row">
    <button type="primary" size="mini" bindtap="chooseLocation">选择位置</button>
    <button type="default" size="mini" bindtap="getCurrentLocation" style="margin-left: 16rpx;">使用当前位置</button>
  </view>

  <view wx:if="{{location}}" class="location-hint">
    <text>已选择位置：</text>
    <text>{{locationAddress || '已获取坐标'}}（{{location.lat}}, {{location.lng}}）</text>
  </view>

  <button class="btn-primary" bindtap="submitOrder">提交工单</button>
</view>