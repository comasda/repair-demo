<view class="page">
  <view class="card">
  <!-- 身份选择 -->
  <view class="row">
    <text>注册身份</text>
    <picker mode="selector" range="{{roles}}" value="{{roleIndex}}" bindchange="onRoleChange">
      <view class="picker">{{ roleText }}</view>
    </picker>
  </view>

  <!-- 手机号 -->
  <view class="row">
    <text>手机号</text>
    <input type="number" maxlength="11" placeholder="请输入手机号" value="{{phone}}" bindinput="onPhoneInput" />
  </view>

  <!-- 验证码 + 获取按钮 -->
  <view class="row">
    <text>验证码</text>
    <input type="number" maxlength="6" placeholder="请输入验证码" value="{{code}}" bindinput="onCodeInput" />
    <button
      size="mini"
      class="btn-code {{countdown>0 || sending ? 'disabled' : ''}}"
      bindtap="sendCaptcha"
      disabled="{{countdown>0 || sending}}"
    >
      {{ countdown>0 ? countdown + 's' : '获取验证码' }}
    </button>
  </view>

  <!-- 密码 & 确认密码 -->
  <view class="row">
    <text>密码</text>
    <input password placeholder="至少6位" value="{{password}}" bindinput="onPwdInput" />
  </view>
  <view class="row">
    <text>确认密码</text>
    <input password placeholder="请再次输入密码" value="{{confirmPwd}}" bindinput="onConfirmPwdInput" />
  </view>

  <!-- 客户必填：姓名、性别 -->
  <view wx:if="{{role==='customer'}}">
    <view class="row">
      <text>姓名</text>
      <input placeholder="请输入姓名" value="{{name}}" bindinput="onNameInput" />
    </view>
    <view class="row">
      <text>性别</text>
      <picker mode="selector" range="{{['男','女']}}" bindchange="onGenderChange">
        <view class="picker">
          {{ gender==='male' ? '男' : (gender==='female' ? '女' : '请选择') }}
        </view>
      </picker>
    </view>
  </view>

  <!-- 师傅必填：身份证姓名 & 身份证号 -->
  <view wx:if="{{role==='technician'}}">
    <view class="row">
      <text>身份证姓名</text>
      <input placeholder="请输入身份证姓名" value="{{idName}}" bindinput="onIdNameInput" />
    </view>
    <view class="row">
      <text>身份证号</text>
      <input placeholder="请输入身份证号码" value="{{idNumber}}" bindinput="onIdNumberInput" />
    </view>
  </view>

      <button type="primary" bindtap="registerUser">注册</button>
    </view>
  <view class="safe-bottom" />
</view>
