<view class="container">

  <view class="title">登录</view>

  <view wx:if="{{mode==='password'}}" class="form-box">
    <!-- 手机号输入（加外框） -->
    <view class="input-box">
      <input
        type="number"
        placeholder="请输入手机号"
        class="login-input"
        bindinput="onPhoneInput"
        maxlength="11"
      />
    </view>
    <!-- 密码输入（加外框 + 小眼睛切换） -->
    <view class="input-box has-icon">
      <!-- 当 passwordVisible=false 时，password=true => 密文；反之明文 -->
      <input
        type="text"
        password="{{!passwordVisible}}"
        placeholder="请输入密码"
        class="login-input"
        bindinput="onPwdInput"
      />
      <image
        class="eye-icon"
        src="{{passwordVisible ? '/assets/eye-open.png' : '/assets/eye-closed.png'}}"
        mode="aspectFit"
        bindtap="togglePasswordVisible"
      />
    </view>
    <button class="btn-primary" bindtap="loginWithPassword">密码登录</button>
  </view>

  <view wx:if="{{mode==='code'}}" class="form-box">
    <input type="text" placeholder="请输入手机号" maxlength="11" bindinput="onPhoneInput" class="input"/>
    <verify-code 
      phone="{{phone}}" 
      bind:codeinput="onCodeInput"
      bind:codesent="onCodeSent"
    />
    <button class="btn-primary" bindtap="loginWithCode">验证码登录</button>
  </view>

  <view class="footer">
    <text class="link" bindtap="switchMode">
      {{mode==='password' ? '用验证码登录' : '用密码登录'}}
    </text>
    <text class="link" bindtap="goRegister">去注册</text>
  </view>
</view>
